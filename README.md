# Lab Information  
- Public DNS IP Address
- Domain name of the target
- Credentials for the IAM user attacker
  - ACCESS_KEY_ID
  - SECRET_ACCESS_KEY
 
# Setup  
- check DNS server of Kali
  `kali@kali:~$ cat /etc/resolv.conf` //nameserver 8.8.8.8
- add a new nameserver line
  ```
  sudo nano /etc/resolv.conf

  # Generated by NetworkManager
  nameserver 44.223.23.191 //offsec Lab - DNS IP
  nameserver 8.8.8.8

  sudo chattr +i /etc/resolv.conf
  sudo chattr -i /etc/resolv.conf (reversable)

  sudo service NetworkManager restart
  ```
- Testing DNS config
  `kali@kali:~$ host www.offseclab.io 44.205.254.229`  
  `kali@kali:~$ host www.offseclab.io`  
- Resetting the DNS Settings
  `kali@kali:~$ sudo systemctl restart NetworkManager`  

# Recon cloud resource on the internet  
- Querying Nameserver Records of offseclab.io Domain
  `kali@kali:~$ host -t ns offseclab.io`  
  offseclab.io name server ns-1536.awsdns-00.co.uk.  
  offseclab.io name server ns-512.awsdns-00.net.  
- Getting the Registrar Information of awsdns-00.com Domain
  `kali@kali:~$ whois awsdns-00.com | grep "Registrant Organization"` //Registrant Organization: Amazon Technologies, Inc.
- Getting the Public IP address of www.offseclab.io  
  `kali@kali:~$ host www.offseclab.io`  // www.offseclab.io has address 52.70.117.69  
- Getting Details of the Public IP Address of the Website
  `kali@kali:~$ host 52.70.117.69`  //69.117.70.52.in-addr.arpa domain name pointer ec2-52-70-117-69.compute-1.amazonaws.com  
  `kali@kali:~$ whois 52.70.117.69 | grep "OrgName"`  //OrgName:        Amazon Technologies Inc.  
- Learn: **resource hosted in AWS (amazonaws.com), and Amazon Elastic Compute Cloud (Amazon EC2) instance**.
- Using **dnsenum** to Automate DNS Reconnaissance of offseclab.io Domain
  `kali@kali:~$ dnsenum offseclab.io --threads 100`
- Learn: likely AWS Route53 service, EC2 service, public IP serves several websites (www.offseclab.io)
- `host -t ns offseclab.io`: query the authoritative DNS servers for the domain offseclab.io  
- Amazon Route 53 manage the offseclab.io domain
- `host -t TXT offseclab.io`
- browse http://www.offseclab.io, inspect browser network:https://s3.amazonaws.com/offseclab-assets-public-vvxepolu/sites/www/images/saphire.jpg. Stored in AWS S3 bucket  
- S3 bucket name is: offseclab-assets-public-axevtewi. Object key is: sites/www/images/saphire.jpg.
- List the content of the bucket: https://s3.amazonaws.com/offseclab-assets-public-vvxepolu/ 
- Guest naming convention: https://s3.amazonaws.com/offseclab-assets-private-vvxepolu/
- Updating the Packages and Installing **cloud-enum** in Kali Linux
  `sudo apt install cloud-enum`  
- Running Quick Scan Against offseclab-assets-public-axevtewi Bucket Using cloud_enum in AWS
  `cloud_enum -k offseclab-assets-public-axevtewi --quickscan --disable-azure --disable-gcp`
- Making a Dictionary of Keywords to Search S3 Bucket
  `for key in "public" "private" "dev" "prod" "development" "production"; do echo "offseclab-assets-$key-axevtewi"; done | tee /tmp/keyfile.txt`
  ```
  offseclab-assets-public-axevtewi
  offseclab-assets-private-axevtewi
  offseclab-assets-dev-axevtewi
  offseclab-assets-prod-axevtewi
  offseclab-assets-development-axevtewi
  offseclab-assets-production-axevtewi
  ```
- Running cloud_enum Against The Generated keyfile.txt File
  `cloud_enum -kf /tmp/keyfile.txt -qs --disable-azure --disable-gcp`
- Custom URLs of All the Three Major CSPs:s3.amazonaws.comï¼Œawsapps.com 

# Recon via CSP API  

# IAM Recon  

# IAM resource Enumeration
